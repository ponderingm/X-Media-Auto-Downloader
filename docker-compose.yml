services:
  downloader:
    build: .
    container_name: x_downloader
    restart: unless-stopped
    volumes:
      - x_downloads:/downloads      # 永続化ボリューム（画像保存先）
      - ./config:/config            # 設定・Cookie・履歴DB
    environment:
      - TZ=Asia/Tokyo

  web:
    image: filebrowser/filebrowser:latest
    container_name: x_viewer
    restart: unless-stopped
    user: 1000:1000
    volumes:
      - x_downloads:/srv            # downloaderと同じ場所を見る
      - x_filebrowser_config:/config # 設定・DB保存先
    environment:
      - FB_DATABASE=/config/filebrowser.db
      - FB_ROOT=/srv
    ports:
      - "8080:80"                   # Coolify側で外部公開設定を行う

volumes:
  x_downloads:                      # 名前付きボリューム
  x_filebrowser_config:             # Filebrowser設定用ボリューム
